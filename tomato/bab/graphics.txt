@name BaB Graphics
@persist

#include "lib/tomato/1.1/tomato_ui"
#include "lib/tomato/1.1/tomato_core"

function string cleanPrinterName(S:string) {
    local Parts = S:explode("_")
    local Clean = array()
    local PrinterWord = ""

    foreach(I, Part:string = Parts) {
        if (Part:lower() == "printer") {
            PrinterWord = "Printer"
        } else {
            Clean:pushString(Part:sub(1,1):upper() + Part:sub(2):lower())
        }
    }

    if (PrinterWord != "") {
        Clean:pushString(PrinterWord)
    }

    return Clean:concat(" ")
}

function bg() {
    EGP:egpClear()
    EGP:egpDrawTopLeft(1)
    Elements = table()
    box(table("x"=0.0, "y"=0.0, "w"= 512.0, "h"=512.0, "r"=0, "g"=149, "b"=255, "size"=15, "halign"=0, "valign"=0))
    box(table("x"=13.0, "y"=11.0, "w"=490.0, "h"=490.0, "r"=255, "g"=255, "b"=255, "radius"=15))
}

function panel() {
    # Panel Background Section
    text(table("text"="BLUE APPLE BANK", "x"=88.0, "y"=30.0, "w"= 349.0, "h"=39.0, "r"=0, "g"=149, "b"=255, "size"=27, "halign"=0, "valign"=1))
    box(table("x"=32.0, "y"=23.0, "w"= 46.0, "h"=46.0, "r"=255, "g"=255, "b"=255, "size"=15, "halign"=0, "valign"=0,
    "material"="../data/tau/cache/files/1a2b6f5882d9172b7dbf5f358808ebf3.png"))
}

function goback(...DWR:array) {
    box(DWR[1, number] ? "DWR" : "Return", table("x"=368.0, "y"=35.0, "w"=115.0, "h"=30.0, "r"=254, "g"=89, "b"=89, "radius"=4.0))
    text(table("text"="[ GO BACK ]", "x"=372.0, "y"=39.0, "w"= 108.0, "h"=21.0, "r"=255, "g"=255, "b"=255, "size"=16, "halign"=1, "valign"=1))
}

function needhelp() {
    text(table("text"="Need help?", "x"=51.0, "y"=453.0, "w"= 239.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=23, "halign"=0, "valign"=1))
    box("RequestHelp", table("x"=321.0, "y"=457.0, "w"=139.0, "h"=31.0, "r"=235, "g"=173, "b"=0, "radius"=4.0))
    text(table("text"="[ REQUEST HELP ]", "x"=333.0, "y"=462.0, "w"= 115.0, "h"=21.0, "r"=255, "g"=255, "b"=255, "size"=16, "halign"=1, "valign"=1))
}

function initialScreen() {
    bg()
    
    text("PressE", table("text"="[ PRESS E TO BEGIN ]", "x"=32.0, "y"=405.0, "w"= 447.0, "h"=29.0, "r"=0, "g"=124, "b"=213,  "size"=18, "halign"=1, "valign"=0))
    text(table("text"="BLUE APPLE BANK", "x"=110.0, "y"=254.0, "w"= 291.0, "h"=25.0, "r"=0, "g"=149, "b"=255, "size"=27, "halign"=1, "valign"=0))
    text(table("text"="Bank Smarter. Live Better.", "x"=110.0, "y"=286.0, "w"= 291.0, "h"=25.0, "r"=0, "g"=115, "b"=197, "size"=18, "halign"=1, "valign"=0)) 

    box("Logo", table("x"=163.0, "y"=70, "w"=189.0, "h"=189.0, "r"=255, "g"=255, "b"=255, "size"=15, "halign"=0, "valign"=0,
    "material"="../data/tau/cache/files/1a2b6f5882d9172b7dbf5f358808ebf3.png"))
}

function tosScreen() {
    bg()
    panel()
    
    text(table("text"="TERMS OF SERVICE", "x"=81.0, "y"=109.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=1, "valign"=0))
    text(table("x"=81.0, "y"=130.0, "w"=349.0, "h"=300.0, "r"=67, "g"=67, "b"=67, "size"=16, "halign"=0, "valign"=0,
    "text"=
    "\n- By using this banking system, you agree that all deposits are final. 
    \n- Membership levels may automatically adjust your payout rates and benefits. 
    \n- In the event of a raid, funds will not be reimbursed unless your membership includes a protection benefit.
    \n- Staff reserve the right to refuse printers or deny service if necessary. 
    \n- Bank rules and membership perks may change at any time without notice."
    ))

    # Accept Button Section
    box("Accept", table("x"=121.0, "y"=405.0, "w"=269.0, "h"=62.0, "r"=26, "g"=224, "b"=39, "radius"=10.0))
    text(table("text"="[ ACCEPT ]", "x"=130.0, "y"=414.0, "w"= 251.0, "h"=43.0, "r"=255, "g"=255, "b"=255, "size"=25, "halign"=1, "valign"=1))
}

function menuScreen() { # Storage items to do, Membership
    bg()
    panel()
    
    text(table("text"="Hello, " + CurrentUser:name() + ".", "x"=81.0, "y"=178.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=23, "halign"=1, "valign"=0))
    box("Membership", table("x"=143.0, "y"=383.0, "w"=225.0, "h"=62.0, "r"=235, "g"=173, "b"=0, "radius"=15.0))
    text(table("text"="[ MEMBERSHIP ]", "x"=151.0, "y"=392.0, "w"= 209.0, "h"=43.0, "r"=255, "g"=255, "b"=255, "size"=17, "halign"=1, "valign"=1))
    box("Statistics", table("x"=143.0, "y"=302.0, "w"=225.0, "h"=62.0, "r"=0, "g"=149, "b"=255, "radius"=15.0))
    text(table("text"="[ STATISTICS ]", "x"=151.0, "y"=311.0, "w"= 209.0, "h"=43.0, "r"=255, "g"=255, "b"=255, "size"=17, "halign"=1, "valign"=1))
    box("Storage", table("x"=143.0, "y"=217.0, "w"=225.0, "h"=62.0, "r"=11, "g"=190, "b"=23, "radius"=15.0))
    text(table("text"="[ STORAGE ]", "x"=151.0, "y"=226.0, "w"= 209.0, "h"=43.0, "r"=255, "g"=255, "b"=255, "size"=17, "halign"=1, "valign"=1))
    text(table("text"="HOME", "x"=81.0, "y"=109.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=1, "valign"=0))  
}

function storageScreen(Storage:table) {
    bg()
    panel()
    goback()
    
    let Text = Storage:count() ? "" : "You do not have anything stored with us currently."
    foreach(_:string, Item:string = Storage) {
        Text += cleanPrinterName(Item) + "\n"
    }
     
    text(table("text"="Storage:", "x"=81.0, "y"=213.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=23, "halign"=1, "valign"=0))
    text("StorageList", table("text"=Text, "x"=81.0, "y"=252.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=16, "halign"=1, "valign"=0))
    
    box("Deposit", table("x"=37.0, "y"=418.0, "w"=209.0, "h"=48.0, "r"=11, "g"=190, "b"=23, "radius"=10.0))
    text(table("text"="[ OPEN DEPOSIT ]", "x"=44.0, "y"=425.0, "w"= 195.0, "h"=33.0, "r"=255, "g"=255, "b"=255, "size"=16, "halign"=1, "valign"=1))
        
    box("Withdraw", table("x"=263.0, "y"=418.0, "w"=209.0, "h"=48.0, "r"=224, "g"=171, "b"=26, "radius"=10.0))
    text(table("text"="[ OPEN WITHDRAWAL ]", "x"=270.0, "y"=425.0, "w"= 195.0, "h"=33.0, "r"=255, "g"=255, "b"=255, "size"=16, "halign"=1, "valign"=1))
    text(table("text"="STORAGE", "x"=81.0, "y"=109.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=1, "valign"=0))   
}

function depositScreen(ItemScan:array) {
    if (!ItemScan:count()) {
        bg()
        panel()
        goback(1)
    }
    
    let Text = ItemScan:count() ? "" : "Please place items in the deposit box."
    let Deposit = ItemScan:count() ? "DEPOSITING..." : "DEPOSIT"
    foreach(_:number, Item:string = ItemScan) {
        Text += cleanPrinterName(Item) + "\n"
    }
    
    text("ItemScan", table("text"=Text, "x"=81.0, "y"=189.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=16, "halign"=1, "valign"=0))
    text("DepositTitle", table("text"=Deposit, "x"=81.0, "y"=109.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=1, "valign"=0))
}

function withdrawScreen(ItemScan:array) {
    if (!ItemScan:count()) {
        bg()
        panel()
        goback(1)
    }
    
    let Text = ItemScan:count() ? "" : "Please wait while a staff member gathers your items."
    let Withdraw = ItemScan:count() ? "WITHDRAWING..." : "WITHDRAW"
    foreach(_:number, Item:string = ItemScan) {
        Text += cleanPrinterName(Item) + "\n"
    }
    
    text("ItemScan", table("text"=Text , "x"=81.0, "y"=189.0, "w"= 349.0, "h"=149.0, "r"=67, "g"=67, "b"=67, "size"=16, "halign"=1, "valign"=0))
    text("DepositTitle", table("text"=Withdraw, "x"=81.0, "y"=109.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=1, "valign"=0))
}

function membershipScreen(Membership:string,Duration:string, MembershipPrices:table) {
    bg()
    panel()
    goback()
    needhelp()
    
    
    box(table("x"=51.0, "y"=169.0, "w"=409.0, "h"=77.0, "r"=219, "g"=219, "b"=219, "radius"=11.0, "size"=3, "outline"=1))
    box(table("x"=51.0, "y"=258.0, "w"=409.0, "h"=78.0, "r"=234, "g"=221, "b"=81, "radius"=11.0, "size"=3, "outline"=1))
    box(table("x"=51.0, "y"=348.0, "w"=409.0, "h"=77.0, "r"=138, "g"=198, "b"=254, "radius"=11.0, "size"=3, "outline"=1))
    
    box(table("x"=51.0, "y"=169.0, "w"=409.0, "h"=77.0, "r"=233, "g"=244, "b"=253, "radius"=11.0))
    box(table("x"=51.0, "y"=258.0, "w"=409.0, "h"=78.0, "r"=233, "g"=244, "b"=253, "radius"=11.0))
    box(table("x"=51.0, "y"=348.0, "w"=409.0, "h"=77.0, "r"=233, "g"=244, "b"=253, "radius"=11.0))
    
    text(table("text"="Your current membership:", "x"=67.0, "y"=148.0, "w"= 375.0, "h"=22.0, "r"=67, "g"=67, "b"=67, "size"=17, "halign"=0, "valign"=0))
    text("CurrentMembership", table("text"=Membership + Duration, "x"=251.0, "y"=148.0, "w"= 220.0, "h"=22.0, "r"=67, "g"=67, "b"=67, "size"=17, "halign"=0, "valign"=0))
    EGP:egpColor(Elements:get("CurrentMembership"), Membership == "Gold" ? vec(235, 173, 0) : Membership == "Platinum" ? vec(0,149,255) : vec(100))
     
    text(table("text"="PLATINUM", "x"=67.0, "y"=367.0-3, "w"=152.0, "h"=30.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=0, "valign"=1))
    text(table("text"="BANK CLAIMS 5%", "x"=69.0, "y"=390.0, "w"= 152.0, "h"=18.0, "r"=67, "g"=67, "b"=67, "size"=18, "halign"=0, "valign"=1))
    text(table("text"="GOLD", "x"=67.0, "y"=276.0-3, "w"= 152.0, "h"=30.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=0, "valign"=1))
    text(table("text"="BANK CLAIMS 15%", "x"=69.0, "y"=298.0, "w"= 152.0, "h"=18.0, "r"=67, "g"=67, "b"=67, "size"=18, "halign"=0, "valign"=1))
    text(table("text"="BASIC", "x"=67.0, "y"=188.0-3, "w"= 152.0, "h"=30.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=0, "valign"=1))
    text(table("text"="BANK CLAIMS 25%", "x"=69.0, "y"=211.0, "w"= 152.0, "h"=18.0, "r"=67, "g"=67, "b"=67, "size"=18, "halign"=0, "valign"=1))
    
    box("PurchaseGoldTemp", table("x"=316.0, "y"=267.0, "w"=135.0, "h"=24.0, "r"=11, "g"=190, "b"=23, "radius"=4.0))
    box("PurchaseGoldPerm", table("x"=316.0, "y"=300.0, "w"=135.0, "h"=24.0, "r"=0, "g"=149, "b"=255, "radius"=4.0))
    text(table("text"="[ PURCHASE TEMP ]", "x"=330.0, "y"=270.0, "w"= 108.0, "h"=18.0, "r"=255, "g"=255, "b"=255, "size"=10, "halign"=1, "valign"=1))
    text(table("text"="[ PURCHASE PERM ]", "x"=330.0, "y"=303.0, "w"= 108.0, "h"=18.0, "r"=255, "g"=255, "b"=255, "size"=10, "halign"=1, "valign"=1))   
    box("PurchasePlatinumTemp", table("x"=316.0, "y"=358.0, "w"=135.0, "h"=24.0, "r"=11, "g"=190, "b"=23, "radius"=4.0))
    box("PurchasePlatinumPerm", table("x"=316.0, "y"=392.0, "w"=135.0, "h"=23.0, "r"=0, "g"=149, "b"=255, "radius"=4.0))
    
    text(table("text"="[ PURCHASE TEMP ]", "x"=330.0, "y"=361.0, "w"= 108.0, "h"=18.0, "r"=255, "g"=255, "b"=255, "size"=10, "halign"=1, "valign"=1))
    text(table("text"="[ PURCHASE PERM ]", "x"=330.0, "y"=395.0, "w"= 108.0, "h"=18.0, "r"=255, "g"=255, "b"=255, "size"=10, "halign"=1, "valign"=1))

    text(table("text"=abbreviateNum(MembershipPrices["Gold", number]/10), "x"=201.0, "y"=273.0-3, "w"= 109.0, "h"=17.0, "r"=11, "g"=190, "b"=23, "size"=16, "halign"=2, "valign"=1))
    text(table("text"=abbreviateNum(MembershipPrices["Gold", number]), "x"=201.0, "y"=306.0-3, "w"= 109.0, "h"=17.0, "r"=0, "g"=149, "b"=255, "size"=16, "halign"=2, "valign"=1))
    text(table("text"=abbreviateNum(MembershipPrices["Platinum", number]/10), "x"=201.0, "y"=364.0-3, "w"= 109.0, "h"=17.0, "r"=11, "g"=190, "b"=23, "size"=16, "halign"=2, "valign"=1))
    text(table("text"=abbreviateNum(MembershipPrices["Platinum", number]), "x"=201.0, "y"=397.0-3, "w"= 109.0, "h"=17.0, "r"=0, "g"=149, "b"=255, "size"=16, "halign"=2, "valign"=1))
    
    text(table("text"="MEMBERSHIP", "x"=81.0, "y"=109.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=1, "valign"=0))
        
}

function statisticsScreen(Membership:string, Duration:string, SessionProfit:number, TotalProfit:number, HourlyRate:number, TotalTime:number) {
    bg()
    panel()
    goback()
    needhelp()
    
    box(table("x"=51.0, "y"=185.0, "w"=409.0, "h"=226.0, "r"=245, "g"=245, "b"=245, "radius"=11.0))
    box(table("x"=51.0, "y"=185.0, "w"=409.0, "h"=226.0, "r"=219, "g"=219, "b"=219, "radius"=11.0, "size"=1, "outline"=1))
    box(table("x"=122.0, "y"=255.0, "w"=268.0, "h"=1.0, "r"=67, "g"=67, "b"=67, "radius"=50.0))
    text(table("text"="PROFIT:", "x"=116.0, "y"=194.0, "w"= 279.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=21, "halign"=1, "valign"=0))
    text("Profit", table("text"="$" + abbreviateNum(SessionProfit) + " (Total: $" + abbreviateNum(TotalProfit) + ")", "x"=116.0, "y"=222.0, "w"=279.0, "h"=30.0, "r"=0, "g"=0, "b"=0, "size"=18, "halign"=1, "valign"=0))
    
    text(table("text"="MEMBERSHIP", "x"=114.0, "y"=346.0, "w"= 279.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=21, "halign"=1, "valign"=0))
    text("MembershipStatus", table("text"=Membership + Duration, "x"=114.0, "y"=374.0, "w"= 279.0, "h"=22.0, "r"=0, "g"=0, "b"=0, "size"=19, "halign"=1, "valign"=0))
    EGP:egpColor(Elements:get("MembershipStatus"), Membership == "Gold" ? vec(235, 173, 0) : Membership == "Platinum" ? vec(0,149,255) : vec(100))
    
    box(table("x"=122.0, "y"=331.0, "w"=268.0, "h"=1.0, "r"=67, "g"=67, "b"=67, "radius"=50.0))
    text(table("text"="HOURLY RATE", "x"=116.0, "y"=270.0, "w"= 279.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=21, "halign"=1, "valign"=0))
    text("HourlyRate", table("text"="$" + abbreviateNum(HourlyRate) + "/hr (" + TotalTime + " hrs)", "x"=116.0, "y"=298.0, "w"= 279.0, "h"=30.0, "r"=0, "g"=0, "b"=0, "size"=18, "halign"=1, "valign"=0))
    
    text(table("text"="Thank you for choosing", "x"=78.0, "y"=150.0, "w"= 206.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=21, "halign"=0, "valign"=0))
    text(table("text"="Blue Apple Bank!", "x"=287.0, "y"=150.0, "w"= 147.0, "h"=39.0, "r"=0, "g"=149, "b"=255, "size"=21, "halign"=0, "valign"=0))
    text(table("text"="STATISTICS", "x"=81.0, "y"=109.0, "w"= 349.0, "h"=39.0, "r"=67, "g"=67, "b"=67, "size"=27, "halign"=1, "valign"=0))
        
}

