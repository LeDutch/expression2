@name Prop RGB
@inputs Color:vector
@inputs Prop:entity
@inputs Prop1:entity
@inputs Prop2:entity
@inputs Prop3:entity
@inputs Prop4:entity
@inputs Prop5:entity
@inputs Prop6:entity
@inputs Prop7:entity
@inputs Prop8:entity
@inputs Prop9:entity
@inputs Prop10:entity
@inputs Prop11:entity
@inputs Prop12:entity
@inputs Prop13:entity
@inputs Prop14:entity
@inputs Prop15:entity
@inputs Prop16:entity
@inputs Prop17:entity
@inputs Prop18:entity
@inputs Prop19:entity
@inputs Prop20:entity
@persist H Rainbow Owner:entity
@trigger

if (first()) {
    #include "library/tomato_lib"
    Owner = owner()
}

runOnTick(1)
if (Rainbow) {
    H += 0.9
    if (H >= 360)
    {
    H = 0
    }
    Color = hsv2rgb(H, 1, 1)
}

Prop:setColor(Color) Prop1:setColor(Color) Prop2:setColor(Color) Prop3:setColor(Color) Prop4:setColor(Color) Prop5:setColor(Color) Prop6:setColor(Color) Prop7:setColor(Color) Prop8:setColor(Color) Prop9:setColor(Color)
Prop10:setColor(Color) Prop11:setColor(Color) Prop12:setColor(Color) Prop13:setColor(Color) Prop14:setColor(Color) Prop15:setColor(Color) Prop17:setColor(Color) Prop18:setColor(Color) Prop19:setColor(Color) Prop20:setColor(Color) 

runOnChat(1)
if(chatClk(Owner))  
{  
    Chat = Owner:lastSaid()
    if(Chat:index(1) == "!")  
    {  
        Arguments = Chat:sub(2):explode(" ")
        Command = Arguments:shiftString() 
        if(Command == "rainbow")  
        {                    
            Rainbow = !Rainbow
        }
    }
    elseif (Command == "changevisual") {
            Text = Arguments[1,string]
            NewOwner = findPlayerByName(Text)
            # If owner exists - error
            if (NewOwner:isValid()) {
                Owner = NewOwner
                Owner:msg("DJ Visuals: Owner changed.")
            }
            else {
                Owner:msg("DJ Visuals: Please select a valid player.")
            }         
    }
}
